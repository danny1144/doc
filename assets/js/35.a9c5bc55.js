(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{390:function(e,t,r){"use strict";r.r(t);var s=r(1),a=Object(s.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"content"},[e._m(0),e._v(" "),e._m(1),e._v(" "),e._m(2),r("p",[e._v("说明：如何快速了解集群的健康状况？green、yellow、red？\ngreen：每个索引的primary shard和replica shard都是active状态的\nyellow：每个索引的primary shard都是active状态的，但是部分replica shard不是active状态，处于不可用的状态\nred：不是所有索引的primary shard都是active状态的，部分索引有数据丢失了")]),e._v(" "),e._m(3),e._v(" "),e._m(4),r("p",[e._v("普通搜索-单索引")]),e._v(" "),e._m(5),e._v(" "),r("p",[e._v("多索引")]),e._v(" "),e._m(6),e._v(" "),r("p",[e._v("所有索引")]),e._v(" "),e._m(7),e._v(" "),e._m(8),e._v(" "),r("table",[e._m(9),e._v(" "),r("tbody",[r("tr",[e._m(10),e._v(" "),r("td",[e._v("The query string (maps to the "),r("code",[e._v("query_string")]),e._v(" query, see "),r("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.6/query-dsl-query-string-query.html",target:"_blank",rel:"noopener noreferrer"}},[r("em",[e._v("Query String Query")]),r("OutboundLink")],1),e._v(" for more details).")])]),e._v(" "),e._m(11),e._v(" "),e._m(12),e._v(" "),e._m(13),e._v(" "),e._m(14),e._v(" "),e._m(15),e._v(" "),e._m(16),e._v(" "),e._m(17),e._v(" "),r("tr",[e._m(18),e._v(" "),r("td",[e._v("Set to "),r("code",[e._v("false")]),e._v(" to disable retrieval of the "),r("code",[e._v("_source")]),e._v(" field. You can also retrieve part of the document by using "),r("code",[e._v("_source_includes")]),e._v(" & "),r("code",[e._v("_source_excludes")]),e._v(" (see the "),r("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.6/search-request-source-filtering.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("request body"),r("OutboundLink")],1),e._v(" documentation for more details)")])]),e._v(" "),e._m(19),e._v(" "),e._m(20),e._v(" "),e._m(21),e._v(" "),r("tr",[e._m(22),e._v(" "),r("td",[e._v("Set to "),r("code",[e._v("false")]),e._v(" in order to disable the tracking of the total number of hits that match the query. (see "),r("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.6/index-modules-index-sorting.html",target:"_blank",rel:"noopener noreferrer"}},[r("em",[e._v("Index Sorting")]),r("OutboundLink")],1),e._v(" for more details). Defaults to true.")])]),e._v(" "),e._m(23),e._v(" "),e._m(24),e._v(" "),e._m(25),e._v(" "),e._m(26),e._v(" "),r("tr",[e._m(27),e._v(" "),r("td",[e._v("The type of the search operation to perform. Can be "),r("code",[e._v("dfs_query_then_fetch")]),e._v(" or "),r("code",[e._v("query_then_fetch")]),e._v(". Defaults to "),r("code",[e._v("query_then_fetch")]),e._v(". See "),r("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.6/search-request-search-type.html",target:"_blank",rel:"noopener noreferrer"}},[r("em",[e._v("Search Type")]),r("OutboundLink")],1),e._v(" for more details on the different types of search that can be performed.")])]),e._v(" "),e._m(28)])]),e._v(" "),e._m(29),e._v(" "),e._m(30),e._m(31),e._v(" "),r("table",[r("thead",[r("tr",[e._m(32),e._v(" "),r("th",[e._v("A search timeout, bounding the search request to be executed within the specified time value and bail with the hits accumulated up to that point when expired. Search requests are canceled after the timeout is reached using the "),r("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.6/search.html#global-search-cancellation",target:"_blank",rel:"noopener noreferrer"}},[e._v("Search Cancellation"),r("OutboundLink")],1),e._v(" mechanism. Defaults to no timeout. See "),r("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.6/common-options.html#time-units",target:"_blank",rel:"noopener noreferrer"}},[e._v("Time units"),r("OutboundLink")],1),e._v(".")])])]),e._v(" "),r("tbody",[e._m(33),e._v(" "),e._m(34),e._v(" "),r("tr",[e._m(35),e._v(" "),r("td",[e._v("The type of the search operation to perform. Can be "),r("code",[e._v("dfs_query_then_fetch")]),e._v(" or "),r("code",[e._v("query_then_fetch")]),e._v(". Defaults to "),r("code",[e._v("query_then_fetch")]),e._v(". See "),r("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.6/search-request-search-type.html",target:"_blank",rel:"noopener noreferrer"}},[r("em",[e._v("Search Type")]),r("OutboundLink")],1),e._v(" for more.")])]),e._v(" "),r("tr",[e._m(36),e._v(" "),r("td",[e._v("Set to "),r("code",[e._v("true")]),e._v(" or "),r("code",[e._v("false")]),e._v(" to enable or disable the caching of search results for requests where "),r("code",[e._v("size")]),e._v(" is 0, ie aggregations and suggestions (no top hits returned). See "),r("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.6/shard-request-cache.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Shard request cache"),r("OutboundLink")],1),e._v(".")])]),e._v(" "),e._m(37),e._v(" "),e._m(38),e._v(" "),e._m(39)])]),e._v(" "),e._m(40),e._v(" "),e._m(41),r("p",[e._v("说一句吧，ES5.0 大改版之后\nindex.query.bool.max_clause_count: 1024\n已经是不可用了，重启后是无法打开ES的，取而代之的是\nindices.query.bool.max_clause_count: 1024")]),e._v(" "),e._m(42),e._v(" "),e._m(43),e._m(44),e._m(45),e._v(" "),e._m(46),e._m(47),e._v(" "),e._m(48),e._m(49),e._v(" "),r("p",[e._v("DELETE /myindex")]),e._v(" "),e._m(50),e._v(" "),e._m(51),e._m(52),e._v(" "),e._m(53),e._v(" "),e._m(54),e._v(" "),e._m(55),r("Vssue",{attrs:{title:"测试"}})],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"es常用搜索"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#es常用搜索"}},[this._v("#")]),this._v(" es常用搜索")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"快速检查集群的健康状况"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#快速检查集群的健康状况"}},[this._v("#")]),this._v(" 快速检查集群的健康状况")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("GET /_cat/health?v\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"快速查看集群中有哪些索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#快速查看集群中有哪些索引"}},[this._v("#")]),this._v(" 快速查看集群中有哪些索引")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("GET /_cat/indices?v\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("code",[this._v("Get /logstash-2019.09.23/_search?q=kubernetes.pod_name:ofm-user")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("code",[this._v("Get /logstash-2019.09.23,logstash-2019.09.22/_search?q=kubernetes.pod_name:ofm-user")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("code",[this._v("Get /all/_search?q=kubernetes.pod_name:ofm-user")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"the-parameters-allowed-in-the-uri-are"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#the-parameters-allowed-in-the-uri-are"}},[this._v("#")]),this._v(" The parameters allowed in the URI are:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",[this._v("Name")]),this._v(" "),t("th",[this._v("Description")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("td",[t("code",[this._v("q")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("df")])]),this._v(" "),t("td",[this._v("The default field to use when no field prefix is defined within the query.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("analyzer")])]),this._v(" "),t("td",[this._v("The analyzer name to be used when analyzing the query string.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("analyze_wildcard")])]),this._v(" "),t("td",[this._v("Should wildcard and prefix queries be analyzed or not. Defaults to "),t("code",[this._v("false")]),this._v(".")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("batched_reduce_size")])]),this._v(" "),t("td",[this._v("The number of shard results that should be reduced at once on the coordinating node. This value should be used as a protection mechanism to reduce the memory overhead per search request if the potential number of shards in the request can be large.")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",[r("td",[r("code",[e._v("default_operator")])]),e._v(" "),r("td",[e._v("The default operator to be used, can be "),r("code",[e._v("AND")]),e._v(" or "),r("code",[e._v("OR")]),e._v(". Defaults to "),r("code",[e._v("OR")]),e._v(".")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("lenient")])]),this._v(" "),t("td",[this._v("If set to true will cause format based failures (like providing text to a numeric field) to be ignored. Defaults to false.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("explain")])]),this._v(" "),t("td",[this._v("For each hit, contain an explanation of how scoring of the hits was computed.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("td",[t("code",[this._v("_source")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("stored_fields")])]),this._v(" "),t("td",[this._v("The selective stored fields of the document to return for each hit, comma delimited. Not specifying any value will cause no fields to return.")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",[r("td",[r("code",[e._v("sort")])]),e._v(" "),r("td",[e._v("Sorting to perform. Can either be in the form of "),r("code",[e._v("fieldName")]),e._v(", or "),r("code",[e._v("fieldName:asc")]),e._v("/"),r("code",[e._v("fieldName:desc")]),e._v(". The fieldName can either be an actual field within the document, or the special "),r("code",[e._v("_score")]),e._v(" name to indicate sorting based on scores. There can be several "),r("code",[e._v("sort")]),e._v(" parameters (order is important).")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("track_scores")])]),this._v(" "),t("td",[this._v("When sorting, set to "),t("code",[this._v("true")]),this._v(" in order to still track scores and return them as part of each hit.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("td",[t("code",[this._v("track_total_hits")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("timeout")])]),this._v(" "),t("td",[this._v("A search timeout, bounding the search request to be executed within the specified time value and bail with the hits accumulated up to that point when expired. Defaults to no timeout.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("terminate_after")])]),this._v(" "),t("td",[this._v("The maximum number of documents to collect for each shard, upon reaching which the query execution will terminate early. If set, the response will have a boolean field "),t("code",[this._v("terminated_early")]),this._v(" to indicate whether the query execution has actually terminated_early. Defaults to no terminate_after.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("from")])]),this._v(" "),t("td",[this._v("The starting from index of the hits to return. Defaults to "),t("code",[this._v("0")]),this._v(".")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("size")])]),this._v(" "),t("td",[this._v("The number of hits to return. Defaults to "),t("code",[this._v("10")]),this._v(".")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("td",[t("code",[this._v("search_type")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("allow_partial_search_results")])]),this._v(" "),t("td",[this._v("Set to "),t("code",[this._v("false")]),this._v(" to return an overall failure if the request would produce partial results. Defaults to true, which will allow partial results in the case of timeouts or partial failures. This default can be controlled using the cluster-level setting "),t("code",[this._v("search.default_allow_partial_results")]),this._v(".")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"request-body-search"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#request-body-search"}},[this._v("#")]),this._v(" request body search")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-{ extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('GET /logstash-2019.09.23/_search\n{\n  "query": {\n    "term": {\n      "kubernetes.container_name": "sso"\n    }\n  }\n}\n\n')])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"params"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#params"}},[this._v("#")]),this._v(" params")])},function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("code",[this._v("timeout")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("from")])]),this._v(" "),t("td",[this._v("To retrieve hits from a certain offset. Defaults to "),t("code",[this._v("0")]),this._v(".")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("size")])]),this._v(" "),t("td",[this._v("The number of hits to return. Defaults to "),t("code",[this._v("10")]),this._v(". If you do not care about getting some hits back but only about the number of matches and/or aggregations, setting the value to "),t("code",[this._v("0")]),this._v(" will help performance.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("td",[t("code",[this._v("search_type")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("td",[t("code",[this._v("request_cache")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("allow_partial_search_results")])]),this._v(" "),t("td",[this._v("Set to "),t("code",[this._v("false")]),this._v(" to return an overall failure if the request would produce partial results. Defaults to true, which will allow partial results in the case of timeouts or partial failures. This default can be controlled using the cluster-level setting "),t("code",[this._v("search.default_allow_partial_results")]),this._v(".")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("terminate_after")])]),this._v(" "),t("td",[this._v("The maximum number of documents to collect for each shard, upon reaching which the query execution will terminate early. If set, the response will have a boolean field "),t("code",[this._v("terminated_early")]),this._v(" to indicate whether the query execution has actually terminated_early. Defaults to no terminate_after.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[t("code",[this._v("batched_reduce_size")])]),this._v(" "),t("td",[this._v("The number of shard results that should be reduced at once on the coordinating node. This value should be used as a protection mechanism to reduce the memory overhead per search request if the potential number of shards in the request can be large.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"快速查询匹配的文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#快速查询匹配的文档"}},[this._v("#")]),this._v(" 快速查询匹配的文档")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("GET /_search?q=kubernetes.container_name:sso&size=0&terminate_after=1\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"from-size分页"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#from-size分页"}},[this._v("#")]),this._v(" from /size分页")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-console extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('GET /_search\n{\n    "from" : 0, "size" : 10,\n    "query" : {\n        "term" : { "kubernetes.container_name": "sso"}\n    }\n}\n')])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-GET /logstash-2019.09.23/_search extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('两个属性满足同一个条件\n{\n  "query": {\n    "multi_match": {\n      "query": "sso",\n      "fields": ["kubernetes.container_name", "kubernetes.pod_name"]\n    }\n  }\n} \n')])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"范围查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#范围查询"}},[this._v("#")]),this._v(" 范围查询")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-GET /ecommerce/product/_search extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('GET /ecommerce/product/_search \n{\n  "query": {\n    "range": {\n      "price": {\n        "gte": 30\n      }\n    }\n  }\n}\n\n')])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"根据条件删除文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#根据条件删除文档"}},[this._v("#")]),this._v(" 根据条件删除文档")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('POST /myindex/book/_delete_by_query\n{\n  "query": {\n    "match": {\n      "name": "c++"\n    }\n  }\n}\n')])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"删除索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除索引"}},[this._v("#")]),this._v(" 删除索引")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"sort排序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sort排序"}},[this._v("#")]),this._v(" sort排序")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-get /myindex/book/_search extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('get /myindex/book/_search\n{\n  "sort": [\n    {\n      "_id": {\n        "order": "desc"\n      }\n    } \n  ] \n}\n')])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"sort-mode-option"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sort-mode-option"}},[this._v("#")]),this._v(" Sort mode option")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("table",[r("thead",[r("tr",[r("th",[r("code",[e._v("min")])]),e._v(" "),r("th",[e._v("Pick the lowest value.")])])]),e._v(" "),r("tbody",[r("tr",[r("td",[r("code",[e._v("max")])]),e._v(" "),r("td",[e._v("Pick the highest value.")])]),e._v(" "),r("tr",[r("td",[r("code",[e._v("sum")])]),e._v(" "),r("td",[e._v("Use the sum of all values as sort value. Only applicable for number based array fields.")])]),e._v(" "),r("tr",[r("td",[r("code",[e._v("avg")])]),e._v(" "),r("td",[e._v("Use the average of all values as sort value. Only applicable for number based array fields.")])]),e._v(" "),r("tr",[r("td",[r("code",[e._v("median")])]),e._v(" "),r("td",[e._v("Use the median of all values as sort value. Only applicable for number based array fields.")])])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"新增索引和文档记录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#新增索引和文档记录"}},[this._v("#")]),this._v(" 新增索引和文档记录")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-PUT /myindex/book/1 extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('指定id\nPUT /myindex/book/1\n{\n  "name":"c++",\n  "description":"C++编程"\n}\n系统生成id\npost /myindex/book\n{\n  "name":"c++",\n  "description":"C++编程"\n}\n')])])])}],!1,null,null,null);t.default=a.exports}}]);